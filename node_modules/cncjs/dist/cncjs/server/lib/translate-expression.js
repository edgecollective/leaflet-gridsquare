"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _evaluateExpression = _interopRequireDefault(require("./evaluate-expression"));

var _logger = _interopRequireDefault(require("./logger"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var log = (0, _logger["default"])('translate-expression');
var re = new RegExp(/\[[^\]]+\]/g);

var translateExpression = function translateExpression(data) {
  var vars = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

  if (!data) {
    return '';
  }

  try {
    data = String(data).replace(re, function (match) {
      var src = match.slice(1, -1);
      var value = (0, _evaluateExpression["default"])(src, vars);
      return value !== undefined ? value : match;
    });
  } catch (e) {
    log.error("data=\"".concat(data, "\", vars=").concat(JSON.stringify(vars)));
    log.error(e);
  }

  return data;
};

var _default = translateExpression;
exports["default"] = _default;